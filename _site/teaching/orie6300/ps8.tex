\documentclass[11pt]{article}

\input{../../preamble}
\usepackage{amsmath, latexsym,amssymb}
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}

\begin{document}

\newcommand{\Tcp}{T_{\mathrm{CP}}}
\newcommand{\Fix}{\mathrm{Fix}}
\problemset{7}{November 3, 2016}{8}{November 10, 2016}

{\huge \textbf{Handwritten assignments will not be accepted.}}\\

This is an optional coding assignment. You will get bonus points if you complete some or all of the assignment. When asked to write code, you must copy your code into this document. You will find the \texttt{$\backslash$verbatim} command helpful.


\begin{enumerate}

\item In this exercise we're going to experiment with MAP, DRS, and CP. 

\paragraph{Compressive Sensing.} We will minimize the $\ell_1$ norm of $w$ subject to the linear constraints $Lw = l$.
\begin{align*}
\min_x & \; \|w\|_1 \\
\text{subject to:} &\; Lw = l.
\end{align*}
The goal of this problem is to find a sparse solution (i.e., a vector with few nonzero entries) to the linear equation.

\paragraph{Code.} Below I provide you code to initialize $L, l$, and a target $w_0$, which we want to recover, and which generates $l$. 

\begin{verbatim}
wellCond = 1; 		% toggle well conditioning on and off.
m = 2000; n = 5120; k = 200; % k is target sparsity.
p = randperm(n); w0 = zeros(n,1); w0(p(1:k)) = sign(randn(k,1));
L  = randn(m,n);
if(wellCond)
    [Q,R] = qr(L',0);  L = Q';
end
l  = L*w0;
\end{verbatim}


\begin{enumerate}
\item Use your answer to Problem 3(a) from Homework 1 to reformulate the compressive sensing problem as a linear program. Refine your answer until the LP is in the form: 
$$
\max_y \{b^T y \mid A^Ty  \leq c\}.
$$
Write code to form $A, b$, and $c$.
\item Write a function that runs the Chambolle-Pock algorithm on this LP with initial point $0$. Make sure you choose $\gamma$ and $\tau$ correctly. Record and output the history of the following quantity
\begin{align*}
 \sqrt{\|Ax^k - b\|^2 + \|\max\{A^Ty^k - c, 0\}\|^2}.
\end{align*} 
For the function, add an input parameter \texttt{tol} so that the algorithm exits once 
$$
 \sqrt{\|Ax^k - b\|^2 + \|\max\{A^Ty^k - c, 0\}\|^2} < \texttt{tol}.
$$
Also output the final iterate of the algorithm.
\item For this linear program, write code to form the matrix $D$ and the vector $d$
\begin{align*}
D := \begin{bmatrix}
A & 0 & 0 \\
0 & A^T & I \\
c^T & - b^T & 0 
\end{bmatrix}
&& \text{and} && d := \begin{bmatrix} 
b \\
c \\ 
0
\end{bmatrix}.
\end{align*}
Write $D$ and $d$ explicitly on your homework.
\item Write a function which computes the projection of a vector onto $C_1 = \{ z \mid Dz = d\}$.
\item Write a function which computes the projection of a vector onto the set $C_2 = \{(x, y, s) \mid x \geq 0, s \geq 0\}$.
\item Write two functions: one which runs MAP and one which runs DRS. In both cases, record and output the history of the following quantity:
\begin{align*}
 \sqrt{\|Ax^k - b\|^2 + \|\max\{A^Ty^k - c, 0\}\|^2}.
\end{align*}
For each function, add an input parameter \texttt{tol} so that the algorithm exits once 
$$
 \sqrt{\|Ax^k - b\|^2 + \|\max\{A^Ty^k - c, 0\}\|^2} < \texttt{tol}.
$$
Also return the last iterate generated by the algorithm. 
\item Run all three algorithms on the input matrix $L$ given above. Generate two \texttt{semilogy} plots, one in the well-conditioned case, and one in the ill-conditioned case, which show 
$$
\sqrt{\|Ax^k - b\|^2 + \|\max\{A^Ty^k - c, 0\}\|^2}
$$ 
for each of the algorithms. For Chambolle-Pock, try to manually adjust the parameters $\tau$ and $\gamma$ for best performance. Which algorithm takes the fewest iterations to reach $\sqrt{\|Ax^k - b\|^2 + \|\max\{A^Ty^k - c, 0\}\|^2} < \texttt{1e-6}$? Which algorithm takes the least amount of computing time?
\item ``Extract" the $w$ component from the last $y$ generated by each algorithm (should be a vector of length $5120$). Call this vector $w$. Plot
\begin{verbatim}
plot(1:n, x0, 1:n, w)
\end{verbatim}
for each algorithm.
\end{enumerate}
\end{enumerate}

\end{document}
